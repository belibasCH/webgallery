{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _regeneratorRuntime from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import Image from'../components/Image';import{storage,db}from'../config/firebase';import'../css/App.css';import{getStorage,ref,list,getDownloadURL,getBlob}from\"firebase/storage\";import{Link}from'react-router-dom';import{collection,getDocs}from\"firebase/firestore\";import JSZip from'jszip';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Start(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),imageList=_useState2[0],setImageList=_useState2[1];console.log(imageList);useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var newImages,querySnapshot;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:newImages=[];_context.next=3;return getDocs(collection(db,\"fab\"));case 3:querySnapshot=_context.sent;querySnapshot.forEach(function(doc){console.log(\"\".concat(doc.id,\" => \").concat(doc.data().description));newImages.push(doc.data());});setImageList(newImages);case 6:case\"end\":return _context.stop();}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[]);function downloadAndZipImages(){return _downloadAndZipImages.apply(this,arguments);}function _downloadAndZipImages(){_downloadAndZipImages=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var zip,_iterator,_step,imageData,response,blob,content,link;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:zip=new JSZip();// Iterate over each image data object\n_iterator=_createForOfIteratorHelper(imageList);_context2.prev=2;_iterator.s();case 4:if((_step=_iterator.n()).done){_context2.next=21;break;}imageData=_step.value;_context2.prev=6;_context2.next=9;return fetch(imageData.url);case 9:response=_context2.sent;_context2.next=12;return response.blob();case 12:blob=_context2.sent;// Add the image to the zip file\nzip.file(\"\".concat(imageData.description||'image',\".jpeg\"),blob,{binary:true});_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](6);console.error('Error downloading image:',_context2.t0);case 19:_context2.next=4;break;case 21:_context2.next=26;break;case 23:_context2.prev=23;_context2.t1=_context2[\"catch\"](2);_iterator.e(_context2.t1);case 26:_context2.prev=26;_iterator.f();return _context2.finish(26);case 29:_context2.next=31;return zip.generateAsync({type:'blob'});case 31:content=_context2.sent;// Create a temporary link to download the zip file\nlink=document.createElement('a');link.href=URL.createObjectURL(content);link.download='HochzeitsFotos.zip';// Programmatically click the link to trigger the download\nlink.click();// Clean up\nURL.revokeObjectURL(link.href);case 37:case\"end\":return _context2.stop();}},_callee2,null,[[2,23,26,29],[6,16]]);}));return _downloadAndZipImages.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"image-galery\",children:imageList.map(function(element,index){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{src:element.url}),/*#__PURE__*/_jsx(\"p\",{children:element.description})]},index);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-container\",children:[/*#__PURE__*/_jsx(Link,{to:\"/upload\",className:\"button\",children:/*#__PURE__*/_jsx(\"div\",{className:\"upload icon\"})}),/*#__PURE__*/_jsx(Link,{to:\"/slideshow\",className:\"button\",children:/*#__PURE__*/_jsx(\"div\",{className:\"fullscreen icon\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"button\",onClick:downloadAndZipImages,children:/*#__PURE__*/_jsx(\"div\",{className:\"download icon\"})})]})]});}export default Start;","map":{"version":3,"names":["React","useEffect","useState","Image","storage","db","getStorage","ref","list","getDownloadURL","getBlob","Link","collection","getDocs","JSZip","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Start","_useState","_useState2","_slicedToArray","imageList","setImageList","console","log","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","newImages","querySnapshot","wrap","_callee$","_context","prev","next","sent","forEach","doc","concat","id","data","description","push","stop","downloadAndZipImages","_downloadAndZipImages","_callee2","zip","_iterator","_step","imageData","response","blob","content","link","_callee2$","_context2","_createForOfIteratorHelper","s","n","done","value","fetch","url","file","binary","t0","error","t1","e","f","finish","generateAsync","type","document","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","children","className","map","element","index","src","to","onClick"],"sources":["/Users/ebr/code/webgalery/src/pages/Start.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Image from '../components/Image';\nimport { storage, db } from '../config/firebase';\nimport '../css/App.css';\nimport { getStorage, ref, list, getDownloadURL, getBlob } from \"firebase/storage\";\nimport { Link } from 'react-router-dom';\nimport { collection, getDocs } from \"firebase/firestore\"; \nimport JSZip from 'jszip';\n\n\n\nfunction Start() {\n  const [imageList, setImageList] = useState([]);\n  console.log(imageList);\n\n  useEffect(() =>{\n    async function fetchData() {\n      const newImages = [];\n      const querySnapshot = await getDocs(collection(db, \"fab\"));\n      querySnapshot.forEach((doc) => {\n        console.log(`${doc.id} => ${doc.data().description}`);\n        newImages.push(doc.data());\n      });\n      setImageList(newImages);\n    }\n    fetchData();\n  }, [])\n  async function downloadAndZipImages() {\n    const zip = new JSZip();\n  \n    // Iterate over each image data object\n    for (const imageData of imageList) {\n      try {\n        // Fetch the image\n        const response = await fetch(imageData.url);\n        const blob = await response.blob();\n  \n        // Add the image to the zip file\n        zip.file(`${imageData.description || 'image'}.jpeg`, blob, { binary: true });\n      } catch (error) {\n        console.error('Error downloading image:', error);\n      }\n    }\n  \n    // Generate the zip file\n    const content = await zip.generateAsync({ type: 'blob' });\n  \n    // Create a temporary link to download the zip file\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(content);\n    link.download = 'HochzeitsFotos.zip';\n  \n    // Programmatically click the link to trigger the download\n    link.click();\n  \n    // Clean up\n    URL.revokeObjectURL(link.href);\n  }\n  \n\n  return (\n    <>\n      <div className=\"image-galery\">\n        {\n          imageList.map((element, index) => (\n            <div key={index}>\n            <img src={element.url}></img>\n            <p>{element.description}</p>\n            </div>\n          ))\n        }\n\n      </div>\n      <div className='button-container'>\n\n        <Link to=\"/upload\" className='button'>\n          <div className='upload icon'></div>\n        </Link>\n        <Link to=\"/slideshow\" className='button'><div className='fullscreen icon'></div></Link>\n        <div className='button' onClick={downloadAndZipImages}><div className='download icon'></div></div>\n\n      </div>\n\n    </>\n  );\n}\nexport default Start;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}