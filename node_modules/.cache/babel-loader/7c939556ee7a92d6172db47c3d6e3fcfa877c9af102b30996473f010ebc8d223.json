{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import Image from'../components/Image';import{storage,db}from'../config/firebase';import'../css/App.css';import{getStorage,ref,list,getDownloadURL,getBlob}from\"firebase/storage\";import{Link}from'react-router-dom';import{collection,getDocs}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Start(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),imageList=_useState2[0],setImageList=_useState2[1];console.log(imageList);useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var newImages,querySnapshot;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:newImages=[];_context.next=3;return getDocs(collection(db,\"js\"));case 3:querySnapshot=_context.sent;querySnapshot.forEach(function(doc){console.log(\"\".concat(doc.id,\" => \").concat(doc.data().description));newImages.push(doc.data());});setImageList(newImages);case 6:case\"end\":return _context.stop();}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[]);function download(){return _download.apply(this,arguments);}function _download(){_download=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var urls;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:urls=[];_context2.next=3;return imageList.forEach(function(img){try{var storageRef=ref(storage,img._location.path_);getBlob(storageRef).then(function(blobImage){var href=URL.createObjectURL(blobImage);var anchorElement=document.createElement('a');anchorElement.href=href;anchorElement.download='WebGalery';document.body.appendChild(anchorElement);anchorElement.click();document.body.removeChild(anchorElement);window.URL.revokeObjectURL(href);});}catch(error){console.log(error);}});case 3:case\"end\":return _context2.stop();}},_callee2);}));return _download.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"image-galery\",children:imageList.map(function(element,index){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{src:element.url}),/*#__PURE__*/_jsx(\"p\",{children:element.description})]},index);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-container\",children:[/*#__PURE__*/_jsx(Link,{to:\"/upload\",className:\"button\",children:/*#__PURE__*/_jsx(\"div\",{className:\"upload icon\"})}),/*#__PURE__*/_jsx(Link,{to:\"/slideshow\",className:\"button\",children:/*#__PURE__*/_jsx(\"div\",{className:\"fullscreen icon\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"button\",onClick:download,children:/*#__PURE__*/_jsx(\"div\",{className:\"download icon\"})})]})]});}export default Start;","map":{"version":3,"names":["React","useEffect","useState","Image","storage","db","getStorage","ref","list","getDownloadURL","getBlob","Link","collection","getDocs","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Start","_useState","_useState2","_slicedToArray","imageList","setImageList","console","log","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","newImages","querySnapshot","wrap","_callee$","_context","prev","next","sent","forEach","doc","concat","id","data","description","push","stop","download","_download","_callee2","urls","_callee2$","_context2","img","storageRef","_location","path_","then","blobImage","href","URL","createObjectURL","anchorElement","document","createElement","body","appendChild","click","removeChild","window","revokeObjectURL","error","children","className","map","element","index","src","url","to","onClick"],"sources":["/Users/ebr/code/webgalery/src/pages/Start.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Image from '../components/Image';\nimport { storage, db } from '../config/firebase';\nimport '../css/App.css';\nimport { getStorage, ref, list, getDownloadURL, getBlob } from \"firebase/storage\";\nimport { Link } from 'react-router-dom';\nimport { collection, getDocs } from \"firebase/firestore\"; \n\n\n\nfunction Start() {\n  const [imageList, setImageList] = useState([]);\n  console.log(imageList);\n\n  useEffect(() =>{\n    async function fetchData() {\n      const newImages = [];\n      const querySnapshot = await getDocs(collection(db, \"js\"));\n      querySnapshot.forEach((doc) => {\n        console.log(`${doc.id} => ${doc.data().description}`);\n        newImages.push(doc.data());\n      });\n      setImageList(newImages);\n    }\n    fetchData();\n  }, [])\n\n  async function download() {\n    const urls = [];\n\n    await imageList.forEach(img => {\n      try {\n        const storageRef = ref(storage, img._location.path_);\n        getBlob(storageRef).then((blobImage) => {\n          const href = URL.createObjectURL(blobImage);\n\n          const anchorElement = document.createElement('a');\n          anchorElement.href = href;\n          anchorElement.download = 'WebGalery';\n\n          document.body.appendChild(anchorElement);\n          anchorElement.click();\n\n          document.body.removeChild(anchorElement);\n          window.URL.revokeObjectURL(href);\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    })\n\n  }\n  return (\n    <>\n      <div className=\"image-galery\">\n        {\n          imageList.map((element, index) => (\n            <div key={index}>\n            <img src={element.url}></img>\n            <p>{element.description}</p>\n            </div>\n          ))\n        }\n\n      </div>\n      <div className='button-container'>\n\n        <Link to=\"/upload\" className='button'>\n          <div className='upload icon'></div>\n        </Link>\n        <Link to=\"/slideshow\" className='button'><div className='fullscreen icon'></div></Link>\n        <div className='button' onClick={download}><div className='download icon'></div></div>\n\n      </div>\n\n    </>\n  );\n}\nexport default Start;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}