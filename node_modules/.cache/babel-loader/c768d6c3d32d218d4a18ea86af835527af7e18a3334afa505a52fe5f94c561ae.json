{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ebr/code/webgalery/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{storage,db}from'../config/firebase';import'../css/Form.css';import{ref,getDownloadURL,uploadBytesResumable}from\"firebase/storage\";import{collection,addDoc}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Form=function Form(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),imgUrl=_useState2[0],setImgUrl=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progresspercent=_useState4[0],setProgresspercent=_useState4[1];var _useState5=useState(\"chooseImage\"),_useState6=_slicedToArray(_useState5,2),formstate=_useState6[0],setFormstate=_useState6[1];//new\n//chooseImage - bild wählen\n// upload - show progress bar\n//description  beschreibung hinzufügen und senden\n//success - bild anzeigen und buttons - galerie gehen der neuen bild hochladen\nvar _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),description=_useState8[0],setDescription=_useState8[1];var uploadImage=function uploadImage(selectedFile){setFormstate(\"upload\");var storageRef=ref(storage,\"js/\".concat(selectedFile.name));var uploadTask=uploadBytesResumable(storageRef,selectedFile);uploadTask.on(\"state_changed\",function(snapshot){var progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgresspercent(progress);},function(error){alert(error);},function(){getDownloadURL(uploadTask.snapshot.ref).then(function(downloadURL){setImgUrl(downloadURL);setFormstate(\"description\");});});};var selectfile=function selectfile(e){setFormstate(\"upload\");uploadImage(e.target.files[0]);};var goback=function goback(){setFormstate(\"chooseImage\");setImgUrl(null);setProgresspercent(0);};var changeDescription=function changeDescription(e){setDescription(e.target.value);};var upload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var dateTime,docRef;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;dateTime=new Date();_context.next=5;return addDoc(collection(db,\"js\"),{url:imgUrl,description:description,date:dateTime});case 5:docRef=_context.sent;console.log(\"Document written with ID: \",docRef.id);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.error(\"Error adding document: \",_context.t0);case 12:console.log('Wird gesendet...');console.log(imgUrl);console.log(description);setFormstate(\"done\");case 16:case\"end\":return _context.stop();}},_callee,null,[[1,9]]);}));return function upload(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"upload-form\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:upload,className:\"form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-circle\",children:[formstate==\"chooseImage\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"circle-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"circle-icon\"}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Datei \",/*#__PURE__*/_jsx(\"br\",{}),\"ausw\\xE4hlen\"]})]}),/*#__PURE__*/_jsx(\"input\",{onChange:selectfile,type:\"file\"})]}),formstate==\"upload\"&&/*#__PURE__*/_jsx(\"div\",{className:\"progressbar\",children:/*#__PURE__*/_jsxs(\"h2\",{children:[progresspercent,\"%\"]})}),formstate==\"description\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"done\",style:{backgroundImage:\"url(\".concat(imgUrl,\")\")},children:/*#__PURE__*/_jsx(\"div\",{className:\"done-icon\"})}),/*#__PURE__*/_jsx(\"div\",{style:{height:\"20px\"}})]})]}),formstate==\"description\"&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"description\",placeholder:\"Grussbotschaft, Beschreibung etc.\",value:description,onChange:changeDescription}),formstate==\"description\"&&/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"hochladen\",children:\"In Diashow einf\\xFCgen\"})]}),formstate==\"done\"&&/*#__PURE__*/_jsx(\"button\",{onClick:goback,children:\"Neues Foto hochladen\"})]});};export default Form;","map":{"version":3,"names":["useEffect","useState","storage","db","ref","getDownloadURL","uploadBytesResumable","collection","addDoc","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Form","_useState","_useState2","_slicedToArray","imgUrl","setImgUrl","_useState3","_useState4","progresspercent","setProgresspercent","_useState5","_useState6","formstate","setFormstate","_useState7","_useState8","description","setDescription","uploadImage","selectedFile","storageRef","concat","name","uploadTask","on","snapshot","progress","Math","round","bytesTransferred","totalBytes","error","alert","then","downloadURL","selectfile","e","target","files","goback","changeDescription","value","upload","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","dateTime","docRef","wrap","_callee$","_context","prev","next","preventDefault","Date","url","date","sent","console","log","id","t0","stop","_x","apply","arguments","className","children","onSubmit","onChange","type","style","backgroundImage","height","placeholder","onClick"],"sources":["/Users/ebr/code/webgalery/src/pages/Form.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { storage, db} from '../config/firebase';\nimport '../css/Form.css';\nimport { ref, getDownloadURL, uploadBytesResumable } from \"firebase/storage\";\nimport { collection, addDoc } from \"firebase/firestore\"; \n\nconst Form = () => {\n  const [imgUrl, setImgUrl] = useState(null);\n  const [progresspercent, setProgresspercent] = useState(0);\n  const [formstate, setFormstate] = useState(\"chooseImage\");\n  \n\n  //new\n  //chooseImage - bild wählen\n  // upload - show progress bar\n  //description  beschreibung hinzufügen und senden\n  //success - bild anzeigen und buttons - galerie gehen der neuen bild hochladen\n \n  const [description, setDescription] = useState(\"\");\n\n\n  const uploadImage = (selectedFile) => {\n    setFormstate(\"upload\");\n    const storageRef = ref(storage, `js/${selectedFile.name}`);\n    const uploadTask = uploadBytesResumable(storageRef, selectedFile);\n\n    uploadTask.on(\"state_changed\",\n      (snapshot) => {\n        const progress =\n          Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100);\n        setProgresspercent(progress);\n      },\n      (error) => {\n        alert(error);\n      },\n      () => {\n        getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {\n          setImgUrl(downloadURL)\n          setFormstate(\"description\")\n        });\n      }\n    );\n  }\n  const selectfile = (e) => {\n    setFormstate(\"upload\");\n    uploadImage(e.target.files[0]);\n  }\n  const goback = () => {\n    setFormstate(\"chooseImage\");\n    setImgUrl(null);\n    setProgresspercent(0);\n  }\n\n  const changeDescription = e => {\n    setDescription(e.target.value)\n  }\n  const upload = async event => {\n    event.preventDefault()\n    try {\n      const dateTime = new Date()\n      const docRef = await addDoc(collection(db, \"js\"), {\n        url: imgUrl,\n        description: description,\n        date: dateTime\n    });\n      console.log(\"Document written with ID: \", docRef.id);\n    } catch (e) {\n      console.error(\"Error adding document: \", e);\n    }\n    console.log('Wird gesendet...')\n    console.log(imgUrl)\n    console.log(description)\n    setFormstate(\"done\")\n\n  }\n\n  return (\n    <div className=\"upload-form\">\n      <form onSubmit={upload} className='form'>\n        <div className='form-circle'>\n          {formstate == \"chooseImage\" &&\n            <>\n              <div className='circle-content'>\n                <div className='circle-icon'></div>\n                <h2>Datei <br></br>auswählen</h2>\n              </div>\n              <input onChange={selectfile} type='file' />\n\n            </>\n          }\n          {formstate == \"upload\" &&\n            <div className=\"progressbar\"><h2>{progresspercent}%</h2></div>\n          }\n          {formstate == \"description\" &&\n          <>\n          <div className=\"done\" style={{ backgroundImage: `url(${imgUrl})` }}><div className=\"done-icon\"></div></div>\n          <div style={{height: \"20px\"}}></div>\n          \n          </>\n          }\n        </div>\n        {formstate == \"description\" &&\n        <input type=\"text\" id=\"description\" placeholder=\"Grussbotschaft, Beschreibung etc.\" value={description} onChange={changeDescription}></input>\n      } \n      \n      {formstate == \"description\" &&\n      <button type='submit' className=\"hochladen\">In Diashow einfügen</button>\n        }\n        </form>\n      {formstate == \"done\" &&\n\n        <button onClick={goback}>Neues Foto hochladen</button>\n      }\n    </div>\n  );\n}\nexport default Form;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}